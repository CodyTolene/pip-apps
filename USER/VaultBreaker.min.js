function gameLoop(){g.setColor('#000'),moved==1&&(g.fillRect(leftWall,paddleY,rightWall,300),moved=!1),g.fillCircle(ballX,ballY,ballRad),begun?ballY<0+ballRad?(velY=Math.abs(velY),ballY=ballRad):ballY>paddleY-ballRad?ballX>paddleX-paddleWidth-ballRad&&ballX<paddleX+paddleWidth+ballRad?(perX=(ballX-paddleX)/(paddleWidth+2),velX=perX*ballSpeed,velYsquared=Math.pow(ballSpeed,2)-Math.pow(velX,2),velY=Math.sqrt(velYsquared),velY=-velY,ballY=paddleY-ballRad,Pip.audioStart('UI/COLUMN.wav')):(g.clear(),lives-=1,begun=!1):ballX<leftWall+ballRad?velX=Math.abs(velX):ballX>rightWall-ballRad&&(velX=Math.abs(velX),velX=-velX):(ballX=paddleX,ballY=paddleY-10,velX=0,velY=0),ballY+=velY,ballX+=velX,bricks.forEach(function(a,b){if(ballY+ballRad>a.y&&ballY-ballRad<a.y+brickHeight&&ballX+ballRad>a.x&&ballX-ballRad<a.x+brickWidth&&(a.hits+=1,Pip.audioStart('UI/PREV.wav'),ballY-velY<=a.y||ballY-velY>=a.y+brickHeight?velY=-velY:velX=-velX),a.hits>=4){g.clear(),bricks.splice(b,1);return}a.hits>0?brickColor=a.hits/5:a.hits==0&&(brickColor=0),g.setColor(theme[0]-brickColor,theme[1]-brickColor,theme[2]-brickColor),g.fillRect(a.x,a.y,a.x+brickWidth,a.y+brickHeight)}),g.setColor(theme[0],theme[1],theme[2]),g.drawRect(0,0,leftWall-5,320),g.drawRect(rightWall+5,0,480,320),g.drawRect(paddleX-paddleWidth,paddleY,paddleX+paddleWidth,300),g.drawCircle(ballX,ballY,ballRad),g.drawString('Lives:'+lives,100,20),g.drawString('Level:'+level,380,20),bricks.length==0&&(begun=!1,level+=1,level==2?pushLevel(level2):level==3?pushLevel(level3):level==4?pushLevel(level4):level==5?pushLevel(level5):level==6?(ballSpeed=18,pushLevel(level6)):level==7?pushLevel(level7):level==8?pushLevel(level8):level==9?pushLevel(level9):level==10&&stopGame()),lives<0&&stopGame(),isNaN(velY)&&(g.clear(),lives-=1,begun=!1),BTN_PLAY.read()&&begun==0&&(begun=!0,velY=-ballSpeed)}function initializeGame(){g.clear(),g.setColor(theme[0],theme[1],theme[2]),g.setFont('6x8',1),level=1,pushLevel(level1),gameLoopInterval=setInterval(gameLoop,gameSpeed),gameLoop()}function stopGame(){gameLoopInterval&&clearInterval(gameLoopInterval),g.clear(),lives<0?Pip.typeText('Game Over!').then(()=>{setTimeout(()=>{E.reboot()},3e3)}):level==10?Pip.typeText('You Win!').then(()=>{setTimeout(()=>{E.reboot()},3e3)}):Pip.typeText('Goodbye!').then(()=>{setTimeout(()=>{E.reboot()},3e3)})}function getTheme(){sysColor=g.getColor(),sysColor=sysColor.toString(16);for(let a=0;a<3;a++)hex=sysColor.charAt(a),integer=parseInt(hex,16),perCol=integer/15,theme[a]=perCol;return}function pushLevel(a){for(let b=0;b<a.length;b++)for(let c=0;c<a[b].length;c++){let d=a[b][c];bricks.push({x:leftWall+(brickWidth+brickGap)*c,y:40+(brickHeight+brickGap)*b,hits:d})}}function handleKnob1(a){a==0&&begun==0&&(begun=!0,velY=-ballSpeed)}function handleKnob2(a){paddleX+=a*10,paddleX-paddleWidth<leftWall?paddleX=leftWall+paddleWidth:paddleX+paddleWidth>rightWall&&(paddleX=rightWall-paddleWidth),a!=0&&(moved=!0)}function handleTorch(){stopGame()}const themeSettingsFolder='USER/ThemePicker';const themeSettingsFile='USER/ThemePicker/theme.json';const screenWidth=g.getWidth();const screenHeight=g.getHeight();const leftWall=60;const rightWall=420;const gameSpeed=80;const paddleWidth=30;const paddleY=290;const ballRad=5;const brickWidth=40;const brickHeight=20;const brickGap=5;const bricks=[];let theme=[0,1,0];let paddleX=240,ballX=240,ballY=270,ballSpeed=15,velX=0,velY=0,velYsquared=0,perX=0,brickColor=0,lives=3,level=0,sysColor=0,integer=0,perCol=0,hex='',moved=!1,begun=!1;const level1=[[1,1,1,1,1,1,1,1],[4,4,4,4,4,4,4,4],[2,2,2,2,2,2,2,2],[4,4,4,4,4,4,4,4],[3,3,3,3,3,3,3,3]];const level2=[[4,1,1,4,4,1,1,4],[4,1,1,1,1,1,1,4],[4,4,4,4,4,4,4,4],[3,3,3,3,3,3,3,3],[3,3,3,3,3,3,3,3]];const level3=[[4,2,2,2,2,2,2,4],[3,0,0,0,0,0,0,3],[3,2,2,2,2,2,2,3],[4,3,3,3,3,3,3,4]];const level4=[[4,2,4,2,4,2,4,2],[2,4,2,4,2,4,2,4],[4,2,4,2,4,2,4,2],[2,4,2,4,2,4,2,4],[4,2,4,2,4,2,4,2]];const level5=[[4,1,1,1,1,1,1,4],[1,1,4,1,1,4,1,1],[2,2,2,2,2,2,2,2],[4,4,0,4,4,0,4,4],[4,0,4,0,0,4,0,4]];const level6=[[4,4,4,2,2,4,4,4],[1,1,1,4,4,1,1,1],[1,4,1,4,4,1,4,1],[1,4,4,1,1,4,4,1],[4,4,4,1,1,4,4,4],[4,4,1,4,4,1,4,4]];const level7=[[4,0,4,0,4,0,4,0],[0,4,0,4,0,4,0,4],[4,0,4,0,4,0,4,0],[0,4,0,4,0,4,0,4],[4,0,4,0,4,0,4,0]];const level8=[[4,1,1,1,1,1,1,1],[1,1,1,1,1,1,4,1],[1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1],[2,2,4,4,4,4,1,1],[2,2,4,4,4,4,4,4]];const level9=[[2,2,2,2,2,2,2,2],[2,0,0,0,0,0,0,2],[2,0,0,0,0,0,0,2],[2,0,0,0,0,0,0,2],[2,2,2,2,2,2,2,2]];getTheme(),g.clear(),Pip.typeText('Welcome to Vault Breaker!\nYou have 3 lives to beat 9 levels.').then(()=>setTimeout(()=>{Pip.typeText('Press the radio knob to launch the ball.\nControl the paddle with the top-right knob.\nPress the torch button to exit. Good luck.').then(()=>setTimeout(()=>{initializeGame()},3e3))},2e3)),Pip.on('knob1',handleKnob1),Pip.on('knob2',handleKnob2),Pip.on('torch',handleTorch)